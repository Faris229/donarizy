<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡∏°‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏µ | V4</title>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;500;700&display=swap');

        :root {
            /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Green & White Theme */
            --bg-color: #f7fff7; /* Very Light Green Background */
            --container-bg: #ffffff; /* White Container */
            --text-color: #333333; /* Dark Gray for text */
            --primary-color: #4CAF50; /* Green Primary */
            --secondary-color: #81c784; /* Lighter Green Accent */
            --success-color: #4CAF50; /* Green */
            --danger-color: #f44336; /* Red */
            --border-color: #e0e0e0; /* Light Gray Border */
            --shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            --house-btn-color: #00bcd4; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏ô‡πâ‡∏≥‡∏ó‡∏∞‡πÄ‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏ö‡πâ‡∏≤‡∏ô */
            --quick-btn-color: #607d8b; /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î */
            --dice-color: #fbc02d; /* ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏ó‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤ */
            --rent-btn-color: #ff9800; /* ‡∏™‡∏µ‡∏™‡πâ‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ */
        }

        body {
            font-family: 'Kanit', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            background: var(--container-bg);
            border-radius: 12px;
            padding: 35px;
            box-shadow: var(--shadow);
            max-width: 680px;
            width: 100%;
            position: relative;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 30px;
            font-weight: 700;
            letter-spacing: 1px;
        }

        h2, h3, h4 {
            color: var(--text-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 5px;
            margin-top: 25px;
            font-weight: 500;
        }
        
        .section-card {
            background-color: #ffffff;
            padding: 18px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid #f0f0f0;
        }
        
        #current-balance {
            font-size: 3em;
            color: var(--primary-color); 
            font-weight: 700;
            display: block;
            text-align: center;
            margin: 15px 0 25px 0;
            letter-spacing: 1px;
        }

        /* Time Lock Styles */
        #lock-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255, 255, 255, 0.98);
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 1.4em;
            font-weight: 500;
            color: var(--text-color);
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            transition: opacity 0.5s;
        }
        
        #lock-overlay button {
            margin-top: 20px;
            background-color: #ff9800;
            width: 80%;
            max-width: 250px;
            box-shadow: 0 2px 5px rgba(255, 152, 0, 0.5);
        }

        /* Input and Button Styles */
        input[type="text"], input[type="number"], textarea {
            padding: 12px;
            margin-bottom: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            width: calc(100% - 24px);
            box-sizing: border-box;
            font-size: 16px;
            background-color: #ffffff;
            color: var(--text-color);
            resize: vertical;
        }
        input:focus, textarea:focus {
            box-shadow: 0 0 0 2px var(--secondary-color);
            outline: none;
            border-color: var(--secondary-color);
        }

        button {
            padding: 12px 18px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 700;
            transition: background-color 0.3s, transform 0.1s;
            margin-right: 10px;
            margin-bottom: 10px;
            color: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.25);
        }
        
        button:active:not(:disabled) {
            transform: scale(0.98);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            color: #f0f0f0;
            box-shadow: none;
        }

        #start-area button {
            background-color: var(--primary-color);
            width: 100%;
            margin-top: 15px;
        }
        
        #randomEventBtn {
            background-color: #795548; /* Brown */
            width: 100%;
        }
        
        .cooldown-status {
            text-align: center;
            color: var(--special-color); 
            font-weight: 500;
            margin-top: 5px;
        }

        /* ---------------------------------- */
        /* ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î */
        /* ---------------------------------- */

        .money-control button {
            width: calc(50% - 15px);
        }
        .money-control .input-group {
            margin-bottom: 15px;
        }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô */
        .quick-amounts {
            display: flex;
            flex-wrap: wrap;
            gap: 8px; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏° */
            margin-top: 10px;
            margin-bottom: 15px;
            justify-content: flex-start;
        }
        .quick-amounts button {
            background-color: var(--quick-btn-color);
            color: white;
            padding: 8px 10px;
            font-size: 14px;
            font-weight: 500;
            margin: 0;
            width: auto;
            min-width: 60px;
        }
        .quick-amounts button:hover {
            background-color: #455a64;
        }

        .add-btn {
            background-color: var(--success-color);
        }

        .subtract-btn {
            background-color: var(--danger-color);
        }
        
        /* ---------------------------------- */
        /* ‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤ ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÅ‡∏•‡∏∞ Animation */
        /* ---------------------------------- */
        .dice-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        #rollDiceBtn {
            background-color: var(--dice-color);
            color: #333;
            width: 100%;
            box-shadow: 0 2px 5px rgba(251, 192, 45, 0.5);
            font-size: 1.1em;
        }
        #rollDiceBtn:hover {
            background-color: #fdd835;
        }
        .dice-result {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
            min-height: 40px; 
        }
        .dice-value {
            font-size: 2em;
            font-weight: 700;
            color: var(--text-color);
            display: inline-block;
            transition: transform 0.1s;
        }
        /* Keyframes ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏™‡∏±‡πà‡∏ô */
        @keyframes roll-effect {
            0% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-3px) rotate(5deg); }
            75% { transform: translateY(3px) rotate(-5deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }
        /* ‡∏Ñ‡∏•‡∏≤‡∏™‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≠‡∏¢ */
        .dice-rolling {
            animation: roll-effect 0.1s infinite;
        }
        #total-roll {
            font-size: 2.5em;
            color: var(--primary-color);
            font-weight: 700;
        }


        /* ---------------------------------- */
        /* ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ */
        /* ---------------------------------- */
        .house-input button {
            background-color: var(--house-btn-color); /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏ô‡πâ‡∏≥‡∏ó‡∏∞‡πÄ‡∏•/‡∏ü‡πâ‡∏≤‡∏≠‡πà‡∏≠‡∏ô */
            width: 100%;
            margin-top: 5px;
            margin-right: 0;
            box-shadow: 0 2px 5px rgba(0, 188, 212, 0.5);
        }
        .house-input button:hover:not(:disabled) {
             background-color: #00a0b6; 
        }

        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô */
        #house-list .action-btns {
            display: flex;
            gap: 5px;
            flex-wrap: nowrap;
        }
        #house-list .rent-btn {
            background-color: var(--rent-btn-color);
            padding: 5px 8px;
            font-size: 13px;
            margin: 0;
            box-shadow: none;
            white-space: nowrap; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏î‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î */
        }
        #house-list .rent-btn:hover {
            background-color: #e68900;
        }
        #house-list .remove-btn {
            background-color: #bdbdbd;
            padding: 5px 8px;
            font-size: 13px;
            margin: 0;
            color: var(--text-color);
            box-shadow: none;
        }
        #house-list .remove-btn:hover {
            background-color: #a0a0a0;
        }

        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ */
        #house-list, #history-list {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        #house-list th, #house-list td, #history-list th, #history-list td {
            border: none;
            border-bottom: 1px solid var(--border-color);
            padding: 10px;
            text-align: left;
            font-size: 0.9em;
        }

        #history-list td:nth-child(2) { /* Description column */
            max-width: 50%; 
            word-wrap: break-word;
        }

        #house-list th, #history-list th {
            background-color: #f0f0f0;
            color: var(--primary-color);
            font-weight: 700;
        }
        
        /* ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏µ */
        #history-list .type-add { color: var(--success-color); font-weight: 700; }
        #history-list .type-subtract { color: var(--danger-color); font-weight: 700; }
        #history-list .type-house-buy { color: #5cb85c; } 
        #history-list .type-house-sell { color: #f0ad4e; } 
        #history-list .type-rent-in { color: var(--rent-btn-color); font-weight: 700; } /* NEW */
        #history-list .type-turn-add { color: #26a69a; } 
        #history-list .type-turn-skip { color: var(--danger-color); } 
        #history-list .type-penalty-physical { color: #d32f2f; font-weight: 700; }
        #history-list .type-start { color: #757575; } 


        /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà */
        .reset-btn {
            background-color: var(--danger-color);
            width: 100%;
            margin-top: 30px;
        }
        hr {
            border: 0;
            border-top: 1px solid var(--border-color);
            margin: 20px 0;
        }

        /* Custom Popup Alert */
        #custom-alert {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.98);
            border: 1px solid var(--border-color);
            border-left: 5px solid var(--primary-color);
            border-radius: 8px;
            padding: 15px 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            font-family: 'Kanit', sans-serif;
            font-size: 1em;
            color: var(--text-color);
            max-width: 350px;
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
            cursor: pointer;
        }

        #custom-alert.show {
            opacity: 1;
            transform: translateY(0);
        }

        #custom-alert .icon {
            font-size: 1.5em;
            margin-right: 10px;
            line-height: 1;
        }
        #custom-alert .message {
            flex-grow: 1;
            font-weight: 500;
        }

        /* Specific alert styles */
        #custom-alert.success { border-left-color: var(--success-color); }
        #custom-alert.error { border-left-color: var(--danger-color); }
        #custom-alert.info { border-left-color: #26a69a; }
        #custom-alert.warning { border-left-color: #ffc107; }
        #custom-alert.money { border-left-color: #2196f3; }
        #custom-alert.dice { border-left-color: var(--dice-color); }
    </style>
</head>
<body>
    <div class="container">
        <h1>üå≥ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡∏°‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏µ üå≥</h1>

        <div id="start-area" class="section-card">
            <h3>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°</h3>
            <input type="text" id="playerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô">
            <input type="number" id="startMoney" placeholder="‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô" value="1500" min="0">
            <label for="startTimeInput">‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° (HH:MM):</label>
            <input type="text" id="startTimeInput" placeholder="‡πÄ‡∏ä‡πà‡∏ô 14:30" value="14:30" maxlength="5">
            <button onclick="startGame()">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏≠</button>
        </div>

        <div id="game-area" style="display:none;">
            <div id="lock-overlay" style="display:none;">
                <p id="lock-message">‚è≥ ‡πÄ‡∏Å‡∏°‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î</p>
                <button onclick="cancelTimeLock()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≠)</button>
            </div>

            <div id="game-controls">
                <h2>‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô: <span id="display-name"></span></h2>
                <h3>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span id="current-balance">0</span></h3>
                
                <hr>
                
                <div class="section-card">
                    <h3>üé≤ ‡∏ó‡∏≠‡∏¢‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤ (2 ‡∏•‡∏π‡∏Å)</h3>
                    <div class="dice-area">
                        <button id="rollDiceBtn" onclick="rollDice()">‡∏ó‡∏≠‡∏¢‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤</button>
                        <div class="dice-result">
                            <span class="dice-value" id="dice-one-value">?</span>
                            <span class="dice-value">+</span>
                            <span class="dice-value" id="dice-two-value">?</span>
                            <span class="dice-value">=</span>
                            <span id="total-roll">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="section-card">
                    <h3>üíµ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô</h3>
                    <div class="money-control">
                        <div class="quick-amounts">
                            <button onclick="setMoneyAmount(100)">100</button>
                            <button onclick="setMoneyAmount(500)">500</button>
                            <button onclick="setMoneyAmount(1000)">1K</button>
                            <button onclick="setMoneyAmount(1500)">1.5K</button>
                            <button onclick="setMoneyAmount(2000)">2K</button>
                        </div>
                        
                        <div class="input-group">
                            <input type="number" id="moneyAmount" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" min="1" value="100">
                            <input type="text" id="moneyDescription" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤, ‡πÄ‡∏Å‡πá‡∏ö‡πÇ‡∏ö‡∏ô‡∏±‡∏™">
                            <button class="add-btn" onclick="addMoney()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô</button>
                            <button class="subtract-btn" onclick="subtractMoney()">- ‡∏•‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</button>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <h3>üéÅ ‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥ (‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•)</h3>
                    <button id="randomEventBtn" onclick="triggerRandomEvent()">‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥</button>
                    <p id="cooldown-status" class="cooldown-status">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</p>
                </div>
                
                <div class="section-card">
                    <h3>üè° ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠/‡∏Ç‡∏≤‡∏¢‡∏ö‡πâ‡∏≤‡∏ô (‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</h3>
                    <div class="house-input">
                        <input type="text" id="houseNumber" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ö‡πâ‡∏≤‡∏ô/‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô">
                        <input type="number" id="housePrice" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤" min="1" value="200">
                        <button onclick="addHouse()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠</button> 
                    </div>
                    
                    <h4>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏∑‡∏≠‡∏Ñ‡∏£‡∏≠‡∏á:</h4>
                    <table id="house-list">
                        <thead>
                            <tr>
                                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô/‡∏ö‡πâ‡∏≤‡∏ô</th>
                                <th>‡∏£‡∏≤‡∏Ñ‡∏≤</th>
                                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody>
                            </tbody>
                    </table>
                </div>
                
                <hr>

                <div class="section-card">
                    <h3>üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h3>
                    <table id="history-list">
                        <thead>
                            <tr>
                                <th style="width: 20%;">‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                                <th style="width: 25%;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô</th>
                            </tr>
                        </thead>
                        <tbody>
                            </tbody>
                    </table>
                </div>

                <button class="reset-btn" onclick="resetGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà (‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)</button>
            </div>
        </div>
    </div>

    <div id="custom-alert" class="hidden" onclick="this.classList.remove('show');">
        <span class="icon"></span>
        <span class="message"></span>
    </div>

    <script>
        let playerName = '';
        let balance = 0;
        let houses = [];
        let transactionHistory = [];
        let isCooldown = false;
        let gameStartTime = ''; 
        let startTimeInterval;
        let alertTimeout;

        const COOLDOWN_TIME = 180000; // 3 ‡∏ô‡∏≤‡∏ó‡∏µ

        const randomEvents = [
            // ‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (Monetary Rewards)
            { title: "‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏¢‡∏∞‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•‡πÑ‡∏î‡πâ", amount: 500, type: "add", source: "‡∏™‡∏∏‡πà‡∏°" },
            { title: "‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏ö‡∏ô‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ", amount: 1800, type: "add", source: "‡∏™‡∏∏‡πà‡∏°" },
            { title: "‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏£‡∏î‡∏Å‡∏à‡∏≤‡∏Å‡∏ç‡∏≤‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å", amount: 2000, type: "add", source: "‡∏™‡∏∏‡πà‡∏°" },
            { title: "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏ô", amount: 1300, type: "add", source: "‡∏™‡∏∏‡πà‡∏°" },
            // ‡∏ö‡∏ó‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Monetary Penalties)
            { title: "‡πÇ‡∏î‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏î‡∏£‡∏ñ‡∏ú‡∏¥‡∏î‡∏ó‡∏µ‡πà", amount: 300, type: "subtract", source: "‡∏™‡∏∏‡πà‡∏°" },
            { title: "‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô", amount: 1200, type: "subtract", source: "‡∏™‡∏∏‡πà‡∏°" },
            { title: "‡πÇ‡∏î‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏†‡∏≤‡∏©‡∏µ‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á", amount: 1000, type: "subtract", source: "‡∏™‡∏∏‡πà‡∏°" },
            // ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô (Turn Rewards)
            { title: "‡∏ö‡∏±‡∏ï‡∏£‡πÇ‡∏≠‡∏Å‡∏≤‡∏™: ‡πÄ‡∏î‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å 1 ‡∏ï‡∏≤", amount: 0, type: "turn-add", source: "‡∏™‡∏∏‡πà‡∏°" },
            { title: "‡∏ö‡∏±‡∏ï‡∏£‡πÇ‡∏≠‡∏Å‡∏≤‡∏™: ‡πÄ‡∏î‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å 2 ‡∏ï‡∏≤", amount: 0, type: "turn-add", source: "‡∏™‡∏∏‡πà‡∏°" },
            // ‡∏ö‡∏ó‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô (Turn Penalties)
            { title: "‡∏ö‡∏±‡∏ï‡∏£‡πÇ‡∏≠‡∏Å‡∏≤‡∏™: ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏î‡∏¥‡∏ô 1 ‡∏ï‡∏≤", amount: 0, type: "turn-skip", source: "‡∏™‡∏∏‡πà‡∏°" },
            { title: "‡∏ö‡∏±‡∏ï‡∏£‡πÇ‡∏≠‡∏Å‡∏≤‡∏™: ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏î‡∏¥‡∏ô 2 ‡∏ï‡∏≤", amount: 0, type: "turn-skip", source: "‡∏™‡∏∏‡πà‡∏°" },
            // ‡∏ö‡∏ó‡∏•‡∏á‡πÇ‡∏ó‡∏©‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ (Physical Penalty)
            { title: "‡∏ö‡∏ó‡∏•‡∏á‡πÇ‡∏ó‡∏©: ‡πÇ‡∏î‡∏ô‡∏ï‡∏ö 10 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á", amount: 0, type: "penalty-physical", source: "‡∏™‡∏∏‡πà‡∏°" }, 
        ];

        // ‡∏î‡∏∂‡∏á element ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
        const startArea = document.getElementById('start-area');
        const gameArea = document.getElementById('game-area');
        const displayName = document.getElementById('display-name');
        const currentBalance = document.getElementById('current-balance');
        const moneyAmountInput = document.getElementById('moneyAmount');
        const moneyDescriptionInput = document.getElementById('moneyDescription'); 
        const houseNumberInput = document.getElementById('houseNumber');
        const housePriceInput = document.getElementById('housePrice');
        const houseListBody = document.querySelector('#house-list tbody');
        const randomEventBtn = document.getElementById('randomEventBtn');
        const cooldownStatus = document.getElementById('cooldown-status');
        const historyListBody = document.querySelector('#history-list tbody');
        const startTimeInput = document.getElementById('startTimeInput');
        const lockOverlay = document.getElementById('lock-overlay');
        const lockMessage = document.getElementById('lock-message'); 
        const gameControls = document.getElementById('game-controls');
        const customAlert = document.getElementById('custom-alert');
        const customAlertIcon = customAlert.querySelector('.icon');
        const customAlertMessage = customAlert.querySelector('.message');
        
        // Dice Elements
        const diceOneValue = document.getElementById('dice-one-value');
        const diceTwoValue = document.getElementById('dice-two-value');
        const totalRoll = document.getElementById('total-roll');
        const rollDiceBtn = document.getElementById('rollDiceBtn');


        // --- Custom Alert Function ---
        function showAlert(message, type = 'info', icon = '') {
            clearTimeout(alertTimeout); 

            customAlert.classList.remove('show', 'success', 'error', 'info', 'warning', 'money', 'dice');
            
            customAlertMessage.textContent = message;
            customAlert.classList.add(type);

            if (!icon) {
                if (type === 'success') icon = '‚úÖ';
                else if (type === 'error') icon = '‚ùå';
                else if (type === 'warning') icon = '‚ö†Ô∏è';
                else if (type === 'money') icon = 'üí∞';
                else if (type === 'dice') icon = 'üé≤';
                else icon = '‚ÑπÔ∏è'; 
            }
            customAlertIcon.textContent = icon;

            customAlert.classList.add('show');

            alertTimeout = setTimeout(() => {
                customAlert.classList.remove('show');
            }, 3000); 
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Time Lock (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á) ---
        function checkStartTime() {
            if (startTimeInterval) clearInterval(startTimeInterval);
            
            const [startH, startM] = gameStartTime.split(':').map(Number);
            let nextCheckTime = 1000;

            const check = () => {
                const now = new Date();
                const currentH = now.getHours();
                const currentM = now.getMinutes();
                const currentS = now.getSeconds();
                
                const currentTimeInSeconds = currentH * 3600 + currentM * 60 + currentS;
                const startTimeInSeconds = startH * 3600 + startM * 60;
                
                if (currentTimeInSeconds >= startTimeInSeconds) {
                    clearInterval(startTimeInterval);
                    gameControls.style.opacity = '1';
                    gameControls.style.pointerEvents = 'auto';
                    lockOverlay.style.display = 'none';
                    showAlert('‡πÄ‡∏Å‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß! üéâ', 'success', '‚úÖ');
                } else {
                    const diffSeconds = startTimeInSeconds - currentTimeInSeconds;
                    const hours = Math.floor(diffSeconds / 3600);
                    const minutes = Math.floor((diffSeconds % 3600) / 60);
                    const seconds = diffSeconds % 60;
                    
                    let message = `‚è≥ ‡πÄ‡∏Å‡∏°‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ${gameStartTime} ‡∏ô.`;
                    
                    if (hours > 0) {
                         message += `<br>‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${hours} ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ${minutes} ‡∏ô‡∏≤‡∏ó‡∏µ ${seconds} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ`;
                    } else if (minutes > 0) {
                        message += `<br>‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${minutes} ‡∏ô‡∏≤‡∏ó‡∏µ ${seconds} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ`;
                    } else {
                        message += `<br>‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å ${seconds} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ`;
                    }
                    
                    lockMessage.innerHTML = message;
                    lockOverlay.style.display = 'flex';
                    gameControls.style.opacity = '0.5';
                    gameControls.style.pointerEvents = 'none';

                    nextCheckTime = 1000;
                }
            };
            
            check();
            startTimeInterval = setInterval(check, nextCheckTime);
        }

        function cancelTimeLock() {
            if (startTimeInterval) clearInterval(startTimeInterval);
            
            gameControls.style.opacity = '1';
            gameControls.style.pointerEvents = 'auto';
            lockOverlay.style.display = 'none';
            
            gameStartTime = '';
            saveData(); 
            
            showAlert('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ üéâ', 'warning', 'üöÄ');
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (recordTransaction, renderHistory, updateBalanceDisplay) ---

        function recordTransaction(type, description, amount) {
            const now = new Date();
            const timeString = `${now.toLocaleTimeString('th-TH', {hour: '2-digit', minute:'2-digit'})}`;
            
            const record = {
                time: timeString,
                type: type, 
                description: description,
                amount: amount
            };
            
            transactionHistory.unshift(record);
            renderHistory();
        }

        function renderHistory() {
            historyListBody.innerHTML = '';
            const recentHistory = transactionHistory.slice(0, 15);

            recentHistory.forEach(record => {
                const row = historyListBody.insertRow();
                const cellTime = row.insertCell(0);
                const cellDesc = row.insertCell(1);
                const cellAmount = row.insertCell(2);

                const amountClass = record.type;
                let amountDisplay = '';

                if (record.type.includes('add') || record.type.includes('rent-in')) {
                    amountDisplay = `+${record.amount.toLocaleString('th-TH')}`;
                } else if (record.type.includes('subtract') || record.type.includes('house-buy')) {
                    amountDisplay = `-${record.amount.toLocaleString('th-TH')}`; // ‡πÅ‡∏™‡∏î‡∏á‡∏¢‡∏≠‡∏î‡∏•‡∏ö
                } else if (record.type.includes('house-sell')) {
                    amountDisplay = `‡∏Ç‡∏≤‡∏¢ ${record.amount.toLocaleString('th-TH')}`;
                } else if (record.type.includes('turn')) {
                    if (record.type.includes('add')) amountDisplay = "‚úÖ ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°";
                    else if (record.type.includes('skip')) amountDisplay = "‚ùå ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏î‡∏¥‡∏ô";
                } else if (record.type.includes('penalty')) {
                    amountDisplay = "üíÄ ‡∏•‡∏á‡πÇ‡∏ó‡∏©";
                } else {
                    amountDisplay = "-";
                }
                
                cellTime.textContent = record.time;
                cellDesc.textContent = record.description;
                cellAmount.innerHTML = `<span class="${amountClass}">${amountDisplay}</span>`;
            });
        }

        function updateBalanceDisplay() {
            currentBalance.textContent = balance.toLocaleString('th-TH');
        }

        function startGame() {
            const nameInput = document.getElementById('playerName').value.trim();
            const startMoneyInput = parseInt(document.getElementById('startMoney').value);
            const timeInput = startTimeInput.value.trim();

            if (nameInput === '' || isNaN(startMoneyInput) || startMoneyInput < 0) {
                showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!', 'error', '‚ùå');
                return;
            }
            if (!/^\d{1,2}:\d{2}$/.test(timeInput)) {
                showAlert('‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (HH:MM)!', 'error', '‚ùå');
                return;
            }

            playerName = nameInput;
            balance = startMoneyInput;
            gameStartTime = timeInput; 
            transactionHistory = [];
            
            recordTransaction('start', `‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏Å‡∏° (‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô: ${startMoneyInput.toLocaleString('th-TH')})`, startMoneyInput);
            
            displayName.textContent = playerName;
            updateBalanceDisplay();

            startArea.style.display = 'none';
            gameArea.style.display = 'block';

            saveData();
            checkStartTime();
            showAlert(`‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ ${gameStartTime} ‡∏ô.`, 'info', '‚è∞');
        }
        
        // --- NEW: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏≠‡∏¢‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå ---
        function rollDice() {
            rollDiceBtn.disabled = true;
            
            const rollCount = 10; // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡πà‡∏°‡∏´‡∏•‡∏≠‡∏Å
            let currentRoll = 0;

            diceOneValue.classList.add('dice-rolling');
            diceTwoValue.classList.add('dice-rolling');

            const finalDice1 = Math.floor(Math.random() * 6) + 1;
            const finalDice2 = Math.floor(Math.random() * 6) + 1;
            const finalTotal = finalDice1 + finalDice2;

            const rollInterval = setInterval(() => {
                // ‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≥‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå
                diceOneValue.textContent = Math.floor(Math.random() * 6) + 1;
                diceTwoValue.textContent = Math.floor(Math.random() * 6) + 1;
                totalRoll.textContent = '?';

                currentRoll++;

                if (currentRoll >= rollCount) {
                    clearInterval(rollInterval);
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏£‡∏¥‡∏á
                    diceOneValue.textContent = finalDice1;
                    diceTwoValue.textContent = finalDice2;
                    totalRoll.textContent = finalTotal;
                    
                    diceOneValue.classList.remove('dice-rolling');
                    diceTwoValue.classList.remove('dice-rolling');
                    rollDiceBtn.disabled = false;

                    let message = `‡∏ó‡∏≠‡∏¢‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤‡πÑ‡∏î‡πâ ${finalDice1} + ${finalDice2} = **${finalTotal}**`;
                    
                    if (finalDice1 === finalDice2) {
                        message += " (‡πÄ‡∏ö‡∏¥‡πâ‡∏•!)";
                    }
                    
                    showAlert(message, 'dice', 'üé≤');
                }
            }, 100); 
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏±‡∏î ---
        function setMoneyAmount(amount) {
            moneyAmountInput.value = amount;
            moneyDescriptionInput.value = ''; 
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏á‡∏¥‡∏ô ---
        function addMoney() { 
            const amount = parseInt(moneyAmountInput.value);
            const description = moneyDescriptionInput.value.trim() || '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á';

            if (isNaN(amount) || amount <= 0) { showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!', 'error', '‚ùå'); return; }
            balance += amount;
            recordTransaction('add', description, amount);
            updateBalanceDisplay(); 
            moneyAmountInput.value = '100'; 
            moneyDescriptionInput.value = '';
            saveData();
            showAlert(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô ${amount.toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó‡πÅ‡∏•‡πâ‡∏ß!`, 'money', '‚¨ÜÔ∏è');
        }
        function subtractMoney() { 
            const amount = parseInt(moneyAmountInput.value);
            const description = moneyDescriptionInput.value.trim() || '‡∏•‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á';

            if (isNaN(amount) || amount <= 0) { showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!', 'error', '‚ùå'); return; }
            balance -= amount;
            recordTransaction('subtract', description, amount);
            updateBalanceDisplay(); 
            moneyAmountInput.value = '100';
            moneyDescriptionInput.value = '';
            saveData();
            showAlert(`‡∏•‡∏ö‡πÄ‡∏á‡∏¥‡∏ô ${amount.toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó‡πÅ‡∏•‡πâ‡∏ß!`, 'money', '‚¨áÔ∏è');
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ö‡πâ‡∏≤‡∏ô ---
        function addHouse() { 
            const number = houseNumberInput.value.trim();
            const price = parseInt(housePriceInput.value);
            
            if (number === '' || isNaN(price) || price <= 0) { 
                showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!', 'error', '‚ùå'); 
                return; 
            }

            // ‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
            balance -= price; 

            const newHouse = { id: Date.now(), number: number, price: price };
            houses.push(newHouse); 
            renderHouses();
            recordTransaction('house-buy', `‡∏ã‡∏∑‡πâ‡∏≠ ${number} (‡∏£‡∏≤‡∏Ñ‡∏≤)`, price);
            updateBalanceDisplay();

            houseNumberInput.value = ''; 
            housePriceInput.value = '200'; 
            saveData();
            showAlert(`‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠ ${number} ‡∏£‡∏≤‡∏Ñ‡∏≤ ${price.toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó‡πÅ‡∏•‡πâ‡∏ß! (‡∏´‡∏±‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß)`, 'success', 'üè†');
        }
        
        function removeHouse(id) { 
            const houseToRemove = houses.find(house => house.id === id);
            if (houseToRemove) { 
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ (‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏≠‡∏á ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
                recordTransaction('house-sell', `‡∏Ç‡∏≤‡∏¢ ${houseToRemove.number} (‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏∏‡∏ô)`, houseToRemove.price);
                showAlert(`‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ ${houseToRemove.number} ‡∏£‡∏≤‡∏Ñ‡∏≤ ${houseToRemove.price.toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó‡πÅ‡∏•‡πâ‡∏ß! (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á)`, 'warning', 'üè†');
            }
            houses = houses.filter(house => house.id !== id);
            renderHouses(); saveData();
        }
        
        // NEW: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤
        function collectRent(id) {
            const house = houses.find(h => h.id === id);
            if (!house) return;
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô
            balance += house.price;
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
            recordTransaction('rent-in', `‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ ${house.number}`, house.price);
            updateBalanceDisplay();
            saveData();
            showAlert(`‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ ${house.number} ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${house.price.toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó!`, 'money', 'üíµ');
        }


        function renderHouses() {
            houseListBody.innerHTML = '';
            houses.forEach(house => {
                const row = houseListBody.insertRow();
                const cellNumber = row.insertCell(0);
                const cellPrice = row.insertCell(1);
                const cellAction = row.insertCell(2);
                
                cellNumber.textContent = house.number;
                cellPrice.textContent = house.price.toLocaleString('th-TH');
                
                const actionDiv = document.createElement('div');
                actionDiv.className = 'action-btns';

                // ‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤
                const rentButton = document.createElement('button');
                rentButton.className = 'rent-btn';
                rentButton.textContent = 'üíµ ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤';
                rentButton.onclick = () => collectRent(house.id);
                
                // ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö/‡∏Ç‡∏≤‡∏¢
                const removeButton = document.createElement('button');
                removeButton.className = 'remove-btn';
                removeButton.textContent = '‡∏•‡∏ö/‡∏Ç‡∏≤‡∏¢';
                removeButton.onclick = () => removeHouse(house.id);
                
                actionDiv.appendChild(rentButton);
                actionDiv.appendChild(removeButton);
                cellAction.appendChild(actionDiv);
            });
        }
        
        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥ (Random Event) (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á) ---
        function startCooldown() {
            isCooldown = true;
            randomEventBtn.disabled = true;
            
            let timeLeft = COOLDOWN_TIME / 1000;
            
            const interval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                const formattedTime = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                randomEventBtn.textContent = `‚è≥ ‡∏£‡∏≠... (${formattedTime})`;
                cooldownStatus.textContent = `‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏µ‡∏ö‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô ${formattedTime}`;
                
                if (timeLeft <= 0) {
                    clearInterval(interval);
                    isCooldown = false;
                    randomEventBtn.disabled = false;
                    randomEventBtn.textContent = '‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥';
                    cooldownStatus.textContent = '‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢';
                    showAlert('‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß!', 'info', 'üéÅ');
                }
            }, 1000);
        }

        function triggerRandomEvent() {
            if (isCooldown) {
                showAlert('‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á Cooldown! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠ 3 ‡∏ô‡∏≤‡∏ó‡∏µ', 'warning', '‚è≥');
                return; 
            }

            const randomIndex = Math.floor(Math.random() * randomEvents.length);
            const event = randomEvents[randomIndex];

            let alertMessage = `üéÅ ‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥: ${event.title}!`;
            let alertType = 'info';
            let alertIcon = 'üéÅ';
            
            if (event.type.includes("add")) {
                balance += event.amount;
                alertMessage += ` ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° ${event.amount.toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó`;
                alertType = 'money';
                alertIcon = '‚¨ÜÔ∏è';
            } else if (event.type.includes("subtract")) {
                balance -= event.amount;
                alertMessage += ` ‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏á‡∏¥‡∏ô ${event.amount.toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó`;
                alertType = 'money';
                alertIcon = '‚¨áÔ∏è';
            } else if (event.type.includes("turn-add")) {
                const turns = event.title.match(/‡∏≠‡∏µ‡∏Å (\d+) ‡∏ï‡∏≤/)[1];
                alertMessage = `üéâ ${event.title} (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° ${turns} ‡∏ï‡∏≤)`;
                alertType = 'success';
                alertIcon = 'üé≤';
            } else if (event.type.includes("turn-skip")) {
                const turns = event.title.match(/‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏î‡∏¥‡∏ô (\d+) ‡∏ï‡∏≤/)[1];
                alertMessage = `üö´ ${event.title} (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ñ‡∏π‡∏Å‡∏Ç‡πâ‡∏≤‡∏° ${turns} ‡∏ï‡∏≤)`;
                alertType = 'error';
                alertIcon = 'üõë';
            } else if (event.type.includes("penalty-physical")) {
                alertMessage = `‚ò†Ô∏è ${event.title} (‡πÇ‡∏õ‡∏£‡∏î‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏ö‡∏ó‡∏•‡∏á‡πÇ‡∏ó‡∏©)`;
                alertType = 'error';
                alertIcon = 'üö®';
            }
            
            showAlert(alertMessage, alertType, alertIcon);
            
            recordTransaction(event.type, `${event.title} (‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥)`, event.amount);
            updateBalanceDisplay();
            saveData();

            startCooldown();
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á) ---

        function saveData() {
            const data = { playerName, balance, houses, transactionHistory, gameStartTime };
            localStorage.setItem('monopolyTrackerData', JSON.stringify(data));
        }

        function loadData() {
            const savedData = localStorage.getItem('monopolyTrackerData');
            if (savedData) {
                const data = JSON.parse(savedData);
                playerName = data.playerName || '';
                balance = data.balance || 0;
                houses = data.houses || [];
                transactionHistory = data.transactionHistory || [];
                gameStartTime = data.gameStartTime || ''; 

                if (playerName) {
                    displayName.textContent = playerName;
                    updateBalanceDisplay();
                    renderHouses();
                    renderHistory();
                    startArea.style.display = 'none';
                    gameArea.style.display = 'block';
                    startTimeInput.value = data.gameStartTime || '14:30';
                    
                    randomEventBtn.disabled = false; 
                    randomEventBtn.textContent = '‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥';
                    cooldownStatus.textContent = '‚úÖ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢';

                    if (gameStartTime) {
                        checkStartTime();
                    } else {
                        lockOverlay.style.display = 'none';
                        gameControls.style.opacity = '1';
                        gameControls.style.pointerEvents = 'auto';
                    }
                }
            }
        }

        function resetGame() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ')) {
                localStorage.removeItem('monopolyTrackerData');
                
                if (startTimeInterval) clearInterval(startTimeInterval);
                
                playerName = ''; balance = 0; houses = []; transactionHistory = []; gameStartTime = '';

                document.getElementById('playerName').value = '';
                document.getElementById('startMoney').value = '1500';
                startTimeInput.value = '14:30';
                houseListBody.innerHTML = '';
                historyListBody.innerHTML = '';
                updateBalanceDisplay();
                
                gameArea.style.display = 'none';
                startArea.style.display = 'block';
                
                isCooldown = false;
                randomEventBtn.disabled = false;
                randomEventBtn.textContent = '‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥';
                cooldownStatus.textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏µ‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢';

                lockOverlay.style.display = 'none';
                
                // Reset Dice display
                diceOneValue.textContent = '?';
                diceTwoValue.textContent = '?';
                totalRoll.textContent = '0';

                showAlert('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏Å‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢', 'success', 'üîÑ');
            }
        }

        window.onload = loadData;
    </script>
</body>
</html>
